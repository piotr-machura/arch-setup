#!/usr/bin/env bash

# Based on scripts by @adi1090x

# Options
shutdown=" "
reboot=" "
logout=" "
abort=" "

rofi_command="rofi -theme $XDG_CONFIG_HOME/rofi/powermenu.rasi"
options="$shutdown\n$reboot\n$logout"
chosen="$(echo -e "$options" | $rofi_command -dmenu -selected-row 0)"
[ -e $chosen ] && exit 1

# Confirm the selection
rofi_command="rofi -theme $XDG_CONFIG_HOME/rofi/powermenu-confirm.rasi"
options="$chosen\n$abort"
confirm="$(echo -e "$options" | $rofi_command -dmenu -selected-row 1)"
[ "$confirm" = "$abort" ] && exit 1

case $chosen in
    $shutdown) systemctl poweroff ;;
    $reboot) systemctl reboot ;;
    $logout) loginctl terminate-session $XDG_SESSION_ID ;;
esac

